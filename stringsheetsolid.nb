(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     11455,        332]
NotebookOptionsPosition[     10776,        306]
NotebookOutlinePosition[     11132,        322]
CellTagsIndexPosition[     11089,        319]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Waves", "Title",
 FontWeight->"Plain"]], "Input",
 CellChangeTimes->{{3.591718723102359*^9, 3.591718732206218*^9}},
 FormatType->"TextForm"],

Cell[OutputFormData["\<\
Create*list*of*points
Create*list*of*springs
Evolve*the*points
p = {pindex, {springs}, m, bc, {{r}, {v}}}
s = {sindex, {p1, p2}, k, l0, {f}}
CreateString[] := {points, interactions}
CreateSheet[] := {points, interactions}
CreateSolid[] := {points, interactions}\
\>", "\<\
Create list of points
Create list of springs
Evolve the points
p = {pindex, {springs}, m, bc, {{r}, {v}}}
s = {sindex, {p1, p2}, k, l0, {f}}
CreateString[] := {points, interactions}
CreateSheet[] := {points, interactions}
CreateSolid[] := {points, interactions}\
\>"], "Input",
 CellChangeTimes->{{3.591702257067905*^9, 3.591702410165896*^9}, {
   3.5917026347788277`*^9, 3.5917026777655697`*^9}, {3.591704469726406*^9, 
   3.591704485085984*^9}, {3.591704620238241*^9, 3.591704620463941*^9}, 
   3.5917046570534897`*^9, {3.5917047782652082`*^9, 3.591704822472209*^9}, {
   3.59170488639021*^9, 3.591704906529406*^9}, 3.591718458943387*^9},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CreateString", "[", 
    RowBox[{"points_", ",", " ", "interactions_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"points", ",", "interactions"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.591717506883198*^9, 3.591717550591506*^9}, {
  3.591717605727408*^9, 3.5917176474153757`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Accessor", " ", "methods"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"object_", ",", "index_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"object", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"index", ",", "5"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"object_", ",", "index_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"object", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"index", ",", "5"}], "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mass", "[", 
     RowBox[{"object_", ",", "index_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"object", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "3"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bc", "[", 
     RowBox[{"object_", ",", "index_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"object", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "4"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ks", "[", 
     RowBox[{"object_", ",", "index_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"object", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "3"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eql", "[", 
     RowBox[{"object_", ",", "index_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"object", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "4"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"object_", ",", "index_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Force", "[", 
      RowBox[{"object", ",", "index"}], "]"}], "/", 
     RowBox[{"mass", "[", 
      RowBox[{"object", ",", "index"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.591717502151984*^9, 3.591717505094034*^9}, {
   3.591717651423003*^9, 3.591717671624764*^9}, {3.591717701665155*^9, 
   3.59171780814928*^9}, {3.591717916387622*^9, 3.591717941514827*^9}, {
   3.591718139297587*^9, 3.59171815318725*^9}, {3.591718274924117*^9, 
   3.591718337801587*^9}, 3.59171856741996*^9, {3.591719245521544*^9, 
   3.5917192803630133`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Setter", " ", "methods"}], "*)"}]], "Input",
 CellChangeTimes->{{3.591719296126958*^9, 3.591719298864641*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"points", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "0"}], ",", 
         RowBox[{"{", "i", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", "i"}], "}"}]}], "]"}], ",", "1", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", "0"}], "||", 
          RowBox[{"i", "\[Equal]", "10"}]}], ",", " ", "1", ",", "0"}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "10"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"springs", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"i", "+", "1"}]}], "}"}], ",", "1", ",", " ", "1", ",", 
       RowBox[{"{", "f", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "9"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.591703513656735*^9, 3.591703595025243*^9}, {
   3.591703661948889*^9, 3.591703703205411*^9}, {3.591703737926056*^9, 
   3.5917037626041803`*^9}, {3.591703810650673*^9, 3.5917039555932198`*^9}, {
   3.5917041806816187`*^9, 3.5917042411090727`*^9}, {3.5917042772377167`*^9, 
   3.591704278325502*^9}, 3.591705110675428*^9, {3.591717997498228*^9, 
   3.591718018714775*^9}, {3.591718497345611*^9, 3.591718498435458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Str", " ", "=", 
   RowBox[{"CreateString", "[", 
    RowBox[{"points", ",", " ", "springs"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.591718537687792*^9, 3.591718550108927*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Force", "[", 
   RowBox[{"object_", ",", "index_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r2", "=", 
       RowBox[{"r", "[", 
        RowBox[{"object", ",", 
         RowBox[{"index", "+", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"r1", "=", 
       RowBox[{"r", "[", 
        RowBox[{"objects", ",", "index"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[ScriptL]0", "=", " ", 
       RowBox[{"springs", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", "4"}], "]"}], "]"}]}], " ", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"k", " ", "=", " ", 
       RowBox[{"ks", "[", 
        RowBox[{"object", ",", "index"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"k", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r2", "-", "r1"}], ")"}], "-", 
       RowBox[{"\[ScriptL]0", "*", 
        FractionBox[
         RowBox[{"r2", "-", "r1"}], 
         RowBox[{"Norm", "[", 
          RowBox[{"r2", "-", "r1"}], "]"}]]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5917049586660147`*^9, 3.591704998058362*^9}, {
  3.59170511820156*^9, 3.5917051337997704`*^9}, {3.591705513910771*^9, 
  3.5917057645526648`*^9}, {3.591706072230187*^9, 3.59170607775035*^9}, {
  3.591706113707644*^9, 3.591706119555285*^9}, {3.591706150466716*^9, 
  3.591706329317231*^9}, {3.5917064170588207`*^9, 3.591706438813567*^9}, {
  3.5917186115095663`*^9, 3.591718702868269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Evolve", "[", 
   RowBox[{"object_", ",", "dt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", " ", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rnew", " ", "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"object", ",", "i"}], "]"}], "+", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"object", ",", "i"}], "]"}], "*", 
         RowBox[{"dt", "/", "2"}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"vnew", " ", "=", " ", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"object", ",", "i"}], "]"}], "+", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"object", ",", "i"}], "]"}], "*", "dt"}]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"object", "[", "r", "]"}], "=", " ", 
     RowBox[{"rnew", "+", 
      RowBox[{"vnew", "*", 
       RowBox[{"dt", "/", "2"}]}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.591718837525249*^9, 3.591718925816778*^9}, {
  3.5917190863523607`*^9, 3.5917192429781647`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", 
      RowBox[{"PointSize", "[", ".01", "]"}], ",", 
      RowBox[{"Point", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"Str", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "10"}], "}"}]}], "]"}], "]"}]}], " ", "}"}], 
    "]"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Points\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.591718384746715*^9, 3.591718391530818*^9}, {
  3.59171855812964*^9, 3.5917185585111017`*^9}}],

Cell[BoxData[
 Graphics3DBox[
  {RGBColor[0, 0, 1], PointSize[0.01], 
   Point3DBox[{{0, 0, 0}, {1, 0, 0}, {2, 0, 0}, {3, 0, 0}, {4, 0, 0}, {5, 0, 
    0}, {6, 0, 0}, {7, 0, 0}, {8, 0, 0}, {9, 0, 0}}]},
  Axes->True,
  ImageSize->600,
  PlotLabel->FormBox["\"Points\"", TraditionalForm],
  ViewPoint->{1.9336380962256938`, -1.7777323449357045`, 2.133239654280333},
  ViewVertical->{0.0460400267602928, 0.5205988418685155, 
   4.464980766313262}]], "Output",
 CellChangeTimes->{
  3.591718392117507*^9, {3.591718558882085*^9, 3.591718571605113*^9}}]
}, Open  ]]
},
WindowSize->{958, 1184},
WindowMargins->{{0, Automatic}, {2, Automatic}},
ShowSelection->True,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 164, 3, 67, "Input"],
Cell[724, 25, 976, 24, 133, "Input"],
Cell[1703, 51, 338, 8, 32, "Input"],
Cell[2044, 61, 2532, 70, 187, "Input"],
Cell[4579, 133, 151, 3, 32, "Input"],
Cell[4733, 138, 1756, 46, 77, "Input"],
Cell[6492, 186, 221, 5, 32, "Input"],
Cell[6716, 193, 1632, 41, 224, "Input"],
Cell[8351, 236, 1104, 30, 121, "Input"],
Cell[CellGroupData[{
Cell[9480, 270, 729, 19, 55, "Input"],
Cell[10212, 291, 548, 12, 465, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
