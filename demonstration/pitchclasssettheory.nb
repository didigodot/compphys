(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     45568,       1063]
NotebookOptionsPosition[     44832,       1034]
NotebookOutlinePosition[     45219,       1051]
CellTagsIndexPosition[     45176,       1048]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Pitch - Class Set Theory\n", "Title"],
 StyleBox["Based on ", "Subtitle"],
 StyleBox["The Structure of Atonal Music", "Subtitle",
  FontSlant->"Italic"],
 StyleBox[" by Allen Forte", "Subtitle"]
}], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.597022881963623*^9, 3.597022900801791*^9}, 
   3.5970270934399767`*^9, {3.597027962230867*^9, 3.597027998114613*^9}, 
   3.5979337282991123`*^9, {3.597956210474593*^9, 3.59795621498143*^9}},
 FormatType->"TextForm",
 FontWeight->"Plain"],

Cell["\<\
A pitch - class set is a set of distinct integers representing pitch classes.
\tCardinal number of a set - number of permutations
\tNormal order - circular permutation for which difference between first and \
last is minimized.
  \tSet must be in ascending order, so 12 must be added appropriately
Interval vectors - \[OpenCurlyDoubleQuote]ics\[CloseCurlyDoubleQuote] show \
interval content:
\tThere are 6 intervals, as follows:
\t0=0
\t1=11
\t2=10
\t ....\
\>", "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.596208904798617*^9, 3.596208918211533*^9}, {
   3.596228054243074*^9, 3.596228054449111*^9}, {3.596368779642105*^9, 
   3.5963687966477947`*^9}, {3.596368903083796*^9, 3.596368904233522*^9}, {
   3.596369011281074*^9, 3.596369078529997*^9}, {3.596369268691723*^9, 
   3.59636927862435*^9}, {3.596371306817026*^9, 3.596371319984241*^9}, {
   3.59637184112173*^9, 3.596371852219036*^9}, {3.5963719272010813`*^9, 
   3.596371933403532*^9}, {3.597022948171289*^9, 3.597022949171311*^9}, 
   3.5970229798493347`*^9, {3.5970272499325237`*^9, 3.59702725237856*^9}, 
   3.597027596204381*^9, {3.597027767141212*^9, 3.597027833737894*^9}, {
   3.597027922046756*^9, 3.597027939964707*^9}, {3.597082772995331*^9, 
   3.597082820579516*^9}, {3.5978890000490437`*^9, 3.597889000783098*^9}},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"generates", " ", "random", " ", 
    RowBox[{"set", ".", " ", "not"}], " ", "used", " ", "for", " ", 
    "demonstration", " ", "atm"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GenerateSet", "[", 
    RowBox[{"notelen_", ",", "sl_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"row", "=", 
       RowBox[{"RandomSample", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "sl"}], "]"}], ",", "sl"}], "]"}]}], "}"}], ",", 
     RowBox[{"Sound", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SoundNote", "[", 
         RowBox[{
          RowBox[{"row", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "notelen"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.59620862632018*^9, 3.596208663237316*^9}, {
  3.596208699348735*^9, 3.5962087008772984`*^9}, {3.59620876114611*^9, 
  3.596208762666564*^9}, {3.596218029215061*^9, 3.596218067201882*^9}, {
  3.59621811193677*^9, 3.59621819626506*^9}, {3.596218342851235*^9, 
  3.59621836121882*^9}, {3.59621840007551*^9, 3.5962184020255327`*^9}, {
  3.596218442693451*^9, 3.5962184522014923`*^9}, {3.5963737386065187`*^9, 
  3.5963737737337923`*^9}, {3.596373983433772*^9, 3.596373993451654*^9}, {
  3.596374033366206*^9, 3.5963740985087147`*^9}, {3.5970256450477047`*^9, 
  3.597025656408182*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"plays", " ", "a", " ", "set"}], ",", " ", 
    RowBox[{"arpeggiated", " ", "then", " ", "as", " ", "a", " ", "chord"}]}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PlaySet", "[", 
     RowBox[{"row_", ",", "notelen_"}], "]"}], ":=", 
    RowBox[{"Sound", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"SoundNote", "[", 
        RowBox[{
         RowBox[{"row", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "notelen"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlaySetChord", "[", 
     RowBox[{"row_", ",", "notelen_"}], "]"}], ":=", 
    RowBox[{"Sound", "[", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SoundNote", "[", 
          RowBox[{
           RowBox[{"row", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"notelen", "/", "3"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"SoundNote", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"row", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}], ",", 
         "notelen"}], "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ButtonLabel", "[", 
     RowBox[{"ps_", ",", " ", "len_"}], "]"}], ":=", 
    RowBox[{"ImageCrop", "[", 
     RowBox[{
      RowBox[{"Rasterize", "[", 
       RowBox[{
        RowBox[{"PlaySet", "[", 
         RowBox[{"ps", ",", " ", "len"}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"200", ",", "40"}], "}"}], ",", "Bottom"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poss", "[", 
     RowBox[{"i_", ",", "tup_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ">", "6"}], " ", "&&",
        " ", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "<", "12"}]}], 
      ",", 
      RowBox[{"Mod", "[", 
       RowBox[{"12", ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"tup", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"tup", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "\[NotEqual]", 
         "0"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ICSet", "[", "ps_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"poss", "[", 
           RowBox[{"i", ",", 
            RowBox[{"Subsets", "[", 
             RowBox[{"ps", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"Subsets", "[", 
              RowBox[{"ps", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
         "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Invert", "[", "ps_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"12", "-", 
        RowBox[{"ps", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ps", "]"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5977852466153793`*^9, 3.597785275873918*^9}, {
  3.597868920840928*^9, 3.597868990843499*^9}, {3.59788612271346*^9, 
  3.597886132911414*^9}, {3.597889236786187*^9, 3.5978892858331137`*^9}, {
  3.597889320823617*^9, 3.597889321726138*^9}, {3.597890083883922*^9, 
  3.597890086012679*^9}, {3.597890131344578*^9, 3.597890135625618*^9}, {
  3.5978909057707148`*^9, 3.597890941025403*^9}, {3.5978910626887302`*^9, 
  3.59789110809494*^9}, {3.597891292622336*^9, 3.597891310566132*^9}, {
  3.597921273071026*^9, 3.597921311546425*^9}, {3.59792144276007*^9, 
  3.597921490165641*^9}, {3.597922295495783*^9, 3.597922318858439*^9}, {
  3.597925078587528*^9, 3.597925090392764*^9}, {3.597927053400419*^9, 
  3.597927091902363*^9}, {3.597932681714753*^9, 3.5979326836270638`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Wozzeck", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"Schoenberg", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"Strauss", "=", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "7"}], "}"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"MTriad", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "8"}], "}"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"MScale", "=", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "3", ",", "5", ",", "6", ",", "8", ",", "10"}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Rndom", "=", 
     RowBox[{"RandomSample", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "11"}], "]"}], ",", "11"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"\"\<Cardinal Number: \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Length", "[", "PCSet", "]"}], "]"}]}], "]"}], ",", 
            "16"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"\"\<Interval Vector: \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"ICSet", "[", "PCSet", "]"}], "]"}]}], "]"}], ",", 
            "16"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Panel", "[", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", "\"\<Original set\>\"", "]"}], ",", 
               "14"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"ToString", "[", "PCSet", "]"}], "]"}], ",", "12"}], 
              "]"}], ",", 
             RowBox[{"PlaySetChord", "[", 
              RowBox[{"PCSet", ",", "len"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"\"\<Transpose at level \>\"", "<>", 
                 RowBox[{"ToString", "[", "n", "]"}]}], "]"}], ",", "14"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"transpose", "[", 
                  RowBox[{"PCSet", ",", "n"}], "]"}], "]"}], "]"}], ",", 
               "12"}], "]"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"ButtonLabel", "[", 
                RowBox[{
                 RowBox[{"transpose", "[", 
                  RowBox[{"PCSet", ",", "n"}], "]"}], ",", "len"}], "]"}], 
               ",", " ", 
               RowBox[{"EmitSound", "[", 
                RowBox[{"Sound", "@", 
                 RowBox[{"PlaySet", "[", 
                  RowBox[{
                   RowBox[{"transpose", "[", 
                    RowBox[{"PCSet", ",", "n"}], "]"}], ",", " ", 
                   RowBox[{"len", "/", "3"}]}], "]"}]}], "]"}]}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", "\"\<Normal form\>\"", "]"}], ",", "14"}],
               "]"}], ",", " ", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"normalOrder", "[", 
                  RowBox[{"cperms", "[", 
                   RowBox[{"Sort", "[", "PCSet", "]"}], "]"}], "]"}], "]"}], 
                "]"}], ",", "12"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"ButtonLabel", "[", 
                RowBox[{
                 RowBox[{"normalOrder", "[", 
                  RowBox[{"cperms", "[", 
                   RowBox[{"Sort", "[", "PCSet", "]"}], "]"}], "]"}], ",", 
                 "len"}], "]"}], ",", " ", 
               RowBox[{"EmitSound", "[", 
                RowBox[{"Sound", "@", 
                 RowBox[{"PlaySet", "[", 
                  RowBox[{
                   RowBox[{"normalOrder", "[", 
                    RowBox[{"cperms", "[", 
                    RowBox[{"Sort", "[", "PCSet", "]"}], "]"}], "]"}], ",", 
                   " ", 
                   RowBox[{"len", "/", "3"}]}], "]"}]}], "]"}]}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", "\"\<Prime form\>\"", "]"}], ",", "14"}], 
              "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"primeForm", "[", 
                  RowBox[{"Sort", "[", "PCSet", "]"}], "]"}], "]"}], "]"}], 
               ",", "12"}], "]"}], ",", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"ButtonLabel", "[", 
                RowBox[{
                 RowBox[{"primeForm", "[", 
                  RowBox[{"Sort", "[", "PCSet", "]"}], "]"}], ",", "len"}], 
                "]"}], ",", " ", 
               RowBox[{"EmitSound", "[", 
                RowBox[{"Sound", "@", 
                 RowBox[{"PlaySet", "[", 
                  RowBox[{
                   RowBox[{"primeForm", "[", 
                    RowBox[{"Sort", "[", "PCSet", "]"}], "]"}], ",", " ", 
                   RowBox[{"len", "/", "3"}]}], "]"}]}], "]"}]}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", "\"\<Inversion\>\"", "]"}], ",", "14"}], 
              "]"}], ",", " ", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Invert", "[", "PCSet", "]"}], "]"}], "]"}], ",", 
               "12"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"ButtonLabel", "[", 
                RowBox[{
                 RowBox[{"Invert", "[", "PCSet", "]"}], ",", "len"}], "]"}], 
               ",", " ", 
               RowBox[{"EmitSound", "[", 
                RowBox[{"Sound", "@", 
                 RowBox[{"PlaySet", "[", 
                  RowBox[{
                   RowBox[{"Invert", "[", "PCSet", "]"}], ",", " ", 
                   RowBox[{"len", "/", "3"}]}], "]"}]}], "]"}]}], "]"}]}], 
            "}"}]}], "}"}], "\[IndentingNewLine]", "]"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PCSet", ",", "Wozzeck", ",", " ", "\"\<Set class\>\""}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Wozzeck", "\[Rule]", "\"\<Wozzeck\>\""}], ",", "Schoenberg", 
       ",", "Strauss", ",", "MTriad", ",", "MScale", ",", 
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "11"}], "]"}], ",", "11"}], "]"}], "\[Rule]", 
        "\"\<Random\>\""}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"len", ",", "1.2", ",", "\"\<Note length\>\""}], "}"}], ",", 
     ".6", ",", "1.8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "\"\<Transpose level\>\""}], "}"}], ",", 
     "0", ",", "8", ",", "1"}], "}"}], ",", " ", 
   RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
   RowBox[{"ContentSize", "\[Rule]", "590"}], ",", " ", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.597021862199161*^9, 3.5970218633367157`*^9}, {
   3.597021930453701*^9, 3.597022004199657*^9}, {3.597022037336694*^9, 
   3.597022087678334*^9}, {3.5970222890805597`*^9, 3.597022316484498*^9}, {
   3.5970224056723003`*^9, 3.597022595679019*^9}, {3.597022703842729*^9, 
   3.597022757151936*^9}, {3.597025334913651*^9, 3.5970253544458113`*^9}, {
   3.5970254398153133`*^9, 3.5970254610145617`*^9}, {3.597025501083084*^9, 
   3.597025537823347*^9}, 3.597025701568284*^9, {3.597025830739592*^9, 
   3.59702584339375*^9}, {3.5970262709600983`*^9, 3.597026286309403*^9}, {
   3.597026419873219*^9, 3.597026432550514*^9}, {3.597026470626657*^9, 
   3.597026513671096*^9}, {3.5970265763906097`*^9, 3.597026591573636*^9}, {
   3.597026911461616*^9, 3.597027004252172*^9}, {3.597027037184567*^9, 
   3.597027045792961*^9}, {3.597027168138825*^9, 3.59702716830407*^9}, {
   3.5970272032573757`*^9, 3.597027207213114*^9}, {3.5970272989895477`*^9, 
   3.597027325866*^9}, {3.5970274219989567`*^9, 3.5970274754496403`*^9}, {
   3.597027505583886*^9, 3.5970275235351887`*^9}, 3.597028102723918*^9, {
   3.5970855760611467`*^9, 3.597085599033709*^9}, {3.597785013412531*^9, 
   3.597785110253536*^9}, {3.5978660964324417`*^9, 3.597866097677882*^9}, {
   3.597866372136101*^9, 3.59786647749648*^9}, {3.597866513497402*^9, 
   3.597866536524675*^9}, {3.597866921781252*^9, 3.597866928883366*^9}, {
   3.59786743296122*^9, 3.597867466435232*^9}, {3.5978680636630583`*^9, 
   3.597868078181417*^9}, {3.597868110514762*^9, 3.597868112186572*^9}, {
   3.597868306752954*^9, 3.597868310584206*^9}, {3.597868607775241*^9, 
   3.5978686210380373`*^9}, {3.5978689725823307`*^9, 3.597869121300373*^9}, {
   3.597869167723785*^9, 3.597869177698106*^9}, {3.5978791383016376`*^9, 
   3.597879187464333*^9}, {3.59788548393533*^9, 3.597885638334324*^9}, {
   3.5978857340388393`*^9, 3.597885780731276*^9}, {3.597885912924794*^9, 
   3.5978859657020493`*^9}, {3.597885996955361*^9, 3.597886097300259*^9}, {
   3.597889747696849*^9, 3.597889748270719*^9}, {3.597922349652714*^9, 
   3.597922354966466*^9}, {3.597922433065184*^9, 3.597922511987988*^9}, 
   3.597922569651194*^9, {3.59792262997233*^9, 3.597922725098731*^9}, {
   3.597925059225678*^9, 3.5979250713894033`*^9}, {3.59792712753749*^9, 
   3.597927129806149*^9}, {3.597931704557526*^9, 3.5979317048203707`*^9}, {
   3.5979324389914427`*^9, 3.5979324840342703`*^9}, {3.597932536792193*^9, 
   3.597932593132987*^9}, {3.5979327109266043`*^9, 3.5979327224454317`*^9}, {
   3.597932753346404*^9, 3.597932775392177*^9}, {3.597932887459516*^9, 
   3.5979329148461523`*^9}, {3.5979330457228127`*^9, 3.597933060889015*^9}, {
   3.597933111680182*^9, 3.5979331824244137`*^9}, {3.59793324489133*^9, 
   3.5979332488937387`*^9}, {3.597933286884994*^9, 3.5979332909063396`*^9}, {
   3.597933432018556*^9, 3.597933463742544*^9}, {3.597933515285819*^9, 
   3.597933519565007*^9}, {3.597933573119915*^9, 3.597933631503716*^9}, {
   3.597935333534521*^9, 3.597935390953494*^9}, {3.597935452976128*^9, 
   3.597935461397718*^9}, {3.597948555918069*^9, 3.597948556772324*^9}, {
   3.5979485893316727`*^9, 3.597948642269861*^9}, {3.597949206204639*^9, 
   3.5979492160350857`*^9}, {3.597949505492426*^9, 3.5979496089644012`*^9}, {
   3.5979497691327257`*^9, 3.597949784842204*^9}, {3.5979499975678596`*^9, 
   3.5979500474515877`*^9}, {3.597950141337286*^9, 3.597950144303438*^9}, {
   3.597950249259767*^9, 3.5979502579301367`*^9}, {3.597950299945705*^9, 
   3.597950317375372*^9}, {3.597950348683371*^9, 3.597950424731475*^9}, {
   3.5979504659885406`*^9, 3.597950470825088*^9}, {3.5979505093175983`*^9, 
   3.597950604351309*^9}, {3.5979512957468023`*^9, 3.5979513063524714`*^9}, {
   3.597951443092732*^9, 3.597951449801612*^9}, {3.597951541527144*^9, 
   3.597951650063224*^9}, {3.597951684252429*^9, 3.597951710354724*^9}, {
   3.5979517788868237`*^9, 3.5979517982119303`*^9}, {3.597951906129669*^9, 
   3.5979519404925823`*^9}, {3.597952011057397*^9, 3.5979521987831087`*^9}, {
   3.5979522331570997`*^9, 3.5979522583677673`*^9}, {3.597952300877863*^9, 
   3.597952326061775*^9}, {3.597952375669938*^9, 3.597952415222052*^9}, {
   3.597952473969359*^9, 3.59795251617795*^9}, {3.597952623118866*^9, 
   3.597952661132181*^9}, {3.597952787502116*^9, 3.597952794726781*^9}, {
   3.597952863101939*^9, 3.5979528665966473`*^9}, {3.59795290603433*^9, 
   3.597952937400034*^9}, {3.5979529696295147`*^9, 3.597953227516151*^9}, {
   3.597956772066658*^9, 3.597956774456171*^9}, {3.597957020047183*^9, 
   3.597957028649098*^9}, 3.597957059680184*^9, {3.597957182003046*^9, 
   3.597957212639711*^9}, {3.5979572745907173`*^9, 3.5979573037213182`*^9}, {
   3.597962697012505*^9, 3.597962736004195*^9}, 3.597962770153553*^9, {
   3.597962897215435*^9, 3.5979628973980417`*^9}, {3.597962948391858*^9, 
   3.5979629638646708`*^9}, {3.597963003039288*^9, 3.5979630063139668`*^9}, {
   3.597963111844782*^9, 3.597963157342244*^9}, {3.5979632023438396`*^9, 
   3.597963213413495*^9}, {3.597963458705656*^9, 3.597963478726122*^9}, {
   3.5979635232872066`*^9, 3.59796353750917*^9}, {3.597963783672571*^9, 
   3.59796379109586*^9}, {3.597963862087175*^9, 3.597963886331894*^9}, {
   3.597963941796268*^9, 3.59796398482066*^9}, {3.597964014827611*^9, 
   3.59796403436467*^9}, {3.597964080711025*^9, 3.5979641002976503`*^9}, {
   3.597964188733967*^9, 3.597964200248514*^9}, 3.597964318341854*^9, {
   3.597965249729146*^9, 3.597965282088345*^9}, {3.597965481551855*^9, 
   3.597965482785371*^9}, {3.597965668929833*^9, 3.597965680361095*^9}, {
   3.597965948634375*^9, 3.5979662136673517`*^9}, {3.597966255446944*^9, 
   3.597966296098084*^9}, {3.597966343047763*^9, 3.5979663655231953`*^9}, {
   3.597966534581017*^9, 3.597966560064211*^9}, {3.5979673025728483`*^9, 
   3.597967331052207*^9}, {3.597967382817926*^9, 3.597967392279471*^9}, {
   3.59796746824504*^9, 3.59796746857444*^9}, {3.597967505051735*^9, 
   3.5979675846614113`*^9}, {3.597967619999682*^9, 3.597967762430847*^9}, {
   3.5979678134506693`*^9, 3.597967864389978*^9}, {3.5979679045084543`*^9, 
   3.597967919774013*^9}, {3.5979689074076853`*^9, 3.5979689259186687`*^9}, {
   3.597969040476819*^9, 3.597969068988616*^9}, {3.597969139354602*^9, 
   3.597969153681169*^9}, {3.597969198496902*^9, 3.597969252861199*^9}, {
   3.597969283371348*^9, 3.5979692852410507`*^9}, {3.597969341503828*^9, 
   3.5979693536134253`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`len$$ = 1.2, $CellContext`n$$ = 
    0, $CellContext`PCSet$$ = {1, 2, 3}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`PCSet$$], {1, 2, 3}, "Set class"}, {{1, 2, 3} -> 
       "Wozzeck", {2, 3, 4}, {4, 5, 7}, {1, 5, 8}, {0, 1, 3, 5, 6, 8, 
       10}, {4, 8, 1, 10, 0, 5, 11, 3, 2, 9, 6} -> "Random"}}, {{
       Hold[$CellContext`len$$], 1.2, "Note length"}, 0.6, 1.8}, {{
       Hold[$CellContext`n$$], 0, "Transpose level"}, 0, 8, 1}}, 
    Typeset`size$$ = {567.2515869140625, {381., 27.0625}}, Typeset`update$$ = 
    0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`PCSet$170447$$ = False, $CellContext`len$170448$$ = 
    0, $CellContext`n$170449$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`len$$ = 1.2, $CellContext`n$$ = 
        0, $CellContext`PCSet$$ = {1, 2, 3}}, "ControllerVariables" :> {
        Hold[$CellContext`PCSet$$, $CellContext`PCSet$170447$$, False], 
        Hold[$CellContext`len$$, $CellContext`len$170448$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$170449$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`Wozzeck = {1, 2, 3}; $CellContext`Schoenberg = {
         2, 3, 4}; $CellContext`Strauss = {4, 5, 7}; $CellContext`MTriad = {1,
          5, 8}; $CellContext`MScale = {0, 1, 3, 5, 6, 8, 
         10}; $CellContext`Rndom = RandomSample[
          Range[0, 11], 11]; Row[{
          Column[{
            Style[
             Text[
              StringJoin["Cardinal Number: ", 
               ToString[
                Length[$CellContext`PCSet$$]]]], 16], 
            Style[
             Text[
              StringJoin["Interval Vector: ", 
               ToString[
                $CellContext`ICSet[$CellContext`PCSet$$]]]], 16]}], 
          Spacer[10], 
          Panel[
           Grid[{{
              Style[
               Text["Original set"], 14], 
              Style[
               Text[
                ToString[$CellContext`PCSet$$]], 12], 
              $CellContext`PlaySetChord[$CellContext`PCSet$$, \
$CellContext`len$$]}, {
              Style[
               Text[
                StringJoin["Transpose at level ", 
                 ToString[$CellContext`n$$]]], 14], 
              Style[
               Text[
                ToString[
                 $CellContext`transpose[$CellContext`PCSet$$, \
$CellContext`n$$]]], 12], 
              Button[
               $CellContext`ButtonLabel[
                $CellContext`transpose[$CellContext`PCSet$$, \
$CellContext`n$$], $CellContext`len$$], 
               EmitSound[
                Sound[
                 $CellContext`PlaySet[
                  $CellContext`transpose[$CellContext`PCSet$$, \
$CellContext`n$$], $CellContext`len$$/3]]]]}, {
              Style[
               Text["Normal form"], 14], 
              Style[
               Text[
                ToString[
                 $CellContext`normalOrder[
                  $CellContext`cperms[
                   Sort[$CellContext`PCSet$$]]]]], 12], 
              Button[
               $CellContext`ButtonLabel[
                $CellContext`normalOrder[
                 $CellContext`cperms[
                  Sort[$CellContext`PCSet$$]]], $CellContext`len$$], 
               EmitSound[
                Sound[
                 $CellContext`PlaySet[
                  $CellContext`normalOrder[
                   $CellContext`cperms[
                    Sort[$CellContext`PCSet$$]]], $CellContext`len$$/3]]]]}, {
             
              Style[
               Text["Prime form"], 14], 
              Style[
               Text[
                ToString[
                 $CellContext`primeForm[
                  Sort[$CellContext`PCSet$$]]]], 12], 
              Button[
               $CellContext`ButtonLabel[
                $CellContext`primeForm[
                 Sort[$CellContext`PCSet$$]], $CellContext`len$$], 
               EmitSound[
                Sound[
                 $CellContext`PlaySet[
                  $CellContext`primeForm[
                   Sort[$CellContext`PCSet$$]], $CellContext`len$$/3]]]]}, {
              Style[
               Text["Inversion"], 14], 
              Style[
               Text[
                ToString[
                 $CellContext`Invert[$CellContext`PCSet$$]]], 12], 
              Button[
               $CellContext`ButtonLabel[
                $CellContext`Invert[$CellContext`PCSet$$], \
$CellContext`len$$], 
               EmitSound[
                Sound[
                 $CellContext`PlaySet[
                  $CellContext`Invert[$CellContext`PCSet$$], \
$CellContext`len$$/3]]]]}}]]}]), 
      "Specifications" :> {{{$CellContext`PCSet$$, {1, 2, 3}, 
          "Set class"}, {{1, 2, 3} -> "Wozzeck", {2, 3, 4}, {4, 5, 7}, {1, 5, 
          8}, {0, 1, 3, 5, 6, 8, 10}, {4, 8, 1, 10, 0, 5, 11, 3, 2, 9, 6} -> 
          "Random"}}, {{$CellContext`len$$, 1.2, "Note length"}, 0.6, 
         1.8}, {{$CellContext`n$$, 0, "Transpose level"}, 0, 8, 1}}, 
      "Options" :> {ContinuousAction -> False, ContentSize -> 590}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{754., {287., 294.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`Wozzeck = {1, 2, 
        3}, $CellContext`Schoenberg = {2, 3, 4}, $CellContext`Strauss = {4, 5,
         7}, $CellContext`MTriad = {1, 5, 8}, $CellContext`MScale = {0, 1, 3, 
        5, 6, 8, 10}, $CellContext`Rndom = {6, 1, 8, 7, 9, 3, 10, 4, 5, 11, 
        2}, $CellContext`ICSet[
         Pattern[$CellContext`ps, 
          Blank[]]] := Table[
         Count[
          Table[
           $CellContext`poss[$CellContext`i, 
            Subsets[$CellContext`ps, {2}]], {$CellContext`i, 1, 
            Length[
             
             Subsets[$CellContext`ps, {
              2}]]}], $CellContext`j], {$CellContext`j, 1, 
          6}], $CellContext`poss[
         Pattern[$CellContext`i, 
          Blank[]], 
         Pattern[$CellContext`tup, 
          Blank[]]] := If[
         And[
         Abs[Part[$CellContext`tup, $CellContext`i, 2] - 
            Part[$CellContext`tup, $CellContext`i, 1]] > 6, 
          Abs[Part[$CellContext`tup, $CellContext`i, 2] - 
            Part[$CellContext`tup, $CellContext`i, 1]] < 12], 
         Mod[12, 
          Abs[
          Part[$CellContext`tup, $CellContext`i, 2] - 
           Part[$CellContext`tup, $CellContext`i, 1]]], 
         If[
         Abs[Part[$CellContext`tup, $CellContext`i, 2] - 
            Part[$CellContext`tup, $CellContext`i, 1]] != 0, 
          Abs[
          Part[$CellContext`tup, $CellContext`i, 2] - 
           Part[$CellContext`tup, $CellContext`i, 
            1]]]], $CellContext`PlaySetChord[
         Pattern[$CellContext`row, 
          Blank[]], 
         Pattern[$CellContext`notelen, 
          Blank[]]] := Sound[
         Append[
          Table[
           SoundNote[
            Part[$CellContext`row, $CellContext`i], $CellContext`notelen/
            3], {$CellContext`i, 1, 
            Length[$CellContext`row]}], 
          SoundNote[
           Table[
            Part[$CellContext`row, $CellContext`i], {$CellContext`i, 1, 
             
             Length[$CellContext`row]}], $CellContext`notelen]]], \
$CellContext`transpose[
         Pattern[$CellContext`s, 
          Blank[]], 
         Pattern[$CellContext`n, 
          Blank[]]] := 
       Table[Part[$CellContext`s, $CellContext`i] + $CellContext`n, \
{$CellContext`i, 1, 
          Length[$CellContext`s]}], $CellContext`ButtonLabel[
         Pattern[$CellContext`ps, 
          Blank[]], 
         Pattern[$CellContext`len, 
          Blank[]]] := ImageCrop[
         Rasterize[
          $CellContext`PlaySet[$CellContext`ps, $CellContext`len], ImageSize -> 
          200], {200, 40}, Bottom], $CellContext`PlaySet[
         Pattern[$CellContext`row, 
          Blank[]], 
         Pattern[$CellContext`notelen, 
          Blank[]]] := Sound[
         Table[
          SoundNote[
           
           Part[$CellContext`row, $CellContext`i], $CellContext`notelen], \
{$CellContext`i, 1, 
           Length[$CellContext`row]}]], $CellContext`normalOrder[
         Pattern[$CellContext`s, 
          Blank[]]] := Part[
         Sort[
          Table[{
            Part[$CellContext`s, $CellContext`i], 
            Part[$CellContext`s, $CellContext`i, 
              Length[$CellContext`s]] - 
            Part[$CellContext`s, $CellContext`i, 1]}, {$CellContext`i, 1, 
            Length[$CellContext`s]}], Part[#, 2] < Part[#2, 2]& ], 1, 
         1], $CellContext`cperms[
         Pattern[$CellContext`s, 
          Blank[]]] := 
       NestList[$CellContext`makeCPerm, $CellContext`s, 
         Length[$CellContext`s] - 1], $CellContext`makeCPerm[
         Pattern[$CellContext`pc, 
          Blank[]]] := $CellContext`ordered[
         $CellContext`cperm[$CellContext`pc]], $CellContext`ordered[
         Pattern[$CellContext`cp, 
          Blank[]]] := Table[
         If[$CellContext`i != 1, 
          If[
          Part[$CellContext`cp, $CellContext`i] < Part[$CellContext`cp, 1], 
           Part[$CellContext`cp, $CellContext`i] + 12, 
           Part[$CellContext`cp, $CellContext`i]], 
          Part[$CellContext`cp, $CellContext`i]], {$CellContext`i, 1, 
          Length[$CellContext`cp]}], $CellContext`cperm[
         Pattern[$CellContext`set, 
          Blank[]]] := Module[{$CellContext`st = Sort[$CellContext`set]}, 
         Delete[
          Append[$CellContext`st, 
           Part[$CellContext`st, 1]], 1]], $CellContext`primeForm[
         Pattern[$CellContext`s, 
          Blank[]]] := Module[{$CellContext`t = $CellContext`normalOrder[
            $CellContext`cperms[$CellContext`s]]}, 
         $CellContext`transpose[$CellContext`t, -
          Part[$CellContext`t, 1]]], $CellContext`Invert[
         Pattern[$CellContext`ps, 
          Blank[]]] := Table[
         Abs[
         12 - Part[$CellContext`ps, $CellContext`i]], {$CellContext`i, 1, 
          Length[$CellContext`ps]}]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.597966216470936*^9, {3.597966265408225*^9, 3.597966296701043*^9}, 
   3.5979663666088047`*^9, 3.5979665606619883`*^9, {3.597967305014374*^9, 
   3.597967331475778*^9}, {3.5979673859892387`*^9, 3.59796739300986*^9}, 
   3.597967469040146*^9, {3.5979675069917717`*^9, 3.5979675285910187`*^9}, {
   3.5979675600009212`*^9, 3.597967586092622*^9}, {3.59796762873842*^9, 
   3.5979676636435003`*^9}, 3.597967697953302*^9, {3.597967727993411*^9, 
   3.597967762792097*^9}, {3.59796783721329*^9, 3.59796786485117*^9}, {
   3.597967910886413*^9, 3.5979679201074266`*^9}, {3.5979689080050583`*^9, 
   3.597968926258047*^9}, {3.5979690479407883`*^9, 3.5979690693360643`*^9}, {
   3.597969132265233*^9, 3.597969163203204*^9}, {3.597969200067958*^9, 
   3.597969253206111*^9}, 3.597969285695506*^9, {3.597969343466157*^9, 
   3.597969354098707*^9}}]
}, Open  ]],

Cell[TextData[{
 StyleBox["normal order, prime form:", "Subsubsection",
  FontWeight->"Plain"],
 StyleBox["\n1) cperm moves first element to end, \n2) cpermordered adds 12 \
to ensure order\n3) makeCPerm applies cpermordered to cperm\n4) cperms \
applies makeCPerm to every element of the list\n5) normalOrder gets the \
normal order of a cperm\n6) primeForm gets prime form by transposing normal \
order so that the first element is 0\n6) transpose adds a number to each \
element\n7) inverse transforms each element to its mod 12 equivalent", "Text",
  
  FontWeight->"Plain"]
}], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.596371974343377*^9, 3.596371978611487*^9}, {
   3.596541637529804*^9, 3.5965416684603367`*^9}, {3.5977851549284077`*^9, 
   3.597785166122993*^9}, {3.5977853039031353`*^9, 3.597785322763446*^9}, {
   3.597785422751733*^9, 3.597785631072915*^9}, 3.59793374556603*^9},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cperm", "[", "set_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"st", "=", 
      RowBox[{"Sort", "[", "set", "]"}]}], "}"}], ",", 
    RowBox[{"Delete", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"st", ",", 
        RowBox[{"st", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "1"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ordered", "[", "cp_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "\[NotEqual]", "1"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         RowBox[{"cp", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"cp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "+", "12"}], ",", 
        RowBox[{"cp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"cp", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "cp", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeCPerm", "[", "pc_", "]"}], ":=", 
  RowBox[{"ordered", "[", 
   RowBox[{"cperm", "[", "pc", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cperms", "[", "s_", "]"}], ":=", 
  RowBox[{"NestList", "[", 
   RowBox[{"makeCPerm", ",", "s", ",", 
    RowBox[{
     RowBox[{"Length", "[", "s", "]"}], "-", "1"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalOrder", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "s", "]"}]}], "]"}], "]"}], "-", 
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "<", 
       RowBox[{"#2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"primeForm", "[", "s_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", "=", 
      RowBox[{"normalOrder", "[", 
       RowBox[{"cperms", "[", "s", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"transpose", "[", 
     RowBox[{"t", ",", 
      RowBox[{
       RowBox[{"-", "1"}], "*", 
       RowBox[{"t", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transpose", "[", 
   RowBox[{"s_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "+", "n"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inverse", "[", "s_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"12", "-", 
       RowBox[{"s", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", "12"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.596544752042263*^9, 3.5965447547583647`*^9}, {
   3.596544796330575*^9, 3.596544833434033*^9}, {3.59654607714474*^9, 
   3.596546196934073*^9}, {3.596546235705632*^9, 3.596546274296529*^9}, {
   3.596546383642956*^9, 3.5965463853605957`*^9}, {3.5965465419027157`*^9, 
   3.596546570942202*^9}, {3.596546642838084*^9, 3.59654664899164*^9}, 
   3.596559311853725*^9, {3.596559342244547*^9, 3.596559346197843*^9}, {
   3.596560067048818*^9, 3.596560067991784*^9}, {3.5965606211250477`*^9, 
   3.596560646903101*^9}, {3.5977855529937277`*^9, 3.597785553632471*^9}, {
   3.597785603379655*^9, 3.5977856035735197`*^9}, {3.597936789014484*^9, 
   3.5979367944581947`*^9}, {3.597936830705669*^9, 3.597936863460443*^9}, {
   3.597937386141417*^9, 3.597937388603488*^9}, {3.5979598234672728`*^9, 
   3.597959826215452*^9}, {3.59796001381392*^9, 3.597960027410305*^9}, {
   3.597960682390533*^9, 3.5979607275045223`*^9}, {3.5979609080484877`*^9, 
   3.597960911655394*^9}, {3.597961319049594*^9, 3.5979613739973173`*^9}, {
   3.5979622312027397`*^9, 3.5979622332206383`*^9}, {3.5979623716893387`*^9, 
   3.59796237201616*^9}, {3.597962444069412*^9, 3.597962475744526*^9}}],

Cell[TextData[{
 StyleBox["Interval Classes\n", "Subsubsection",
  FontWeight->"Plain"],
 StyleBox["Interval vectors - \"ics\" show interval content:\n\tThere are 6 \
intervals, as follows:\n\t0=0\n\t1=11\n\t2=10\n\t ....\nInterval vectors are \
of this form [abcdef] where a represents the number of occurrences of \
interval 0, b number of occurrences of interval 1, etc. \nThree properties: \
'unique vector entries', 'maximum number of some ic', 'near equal \
distribution if entires'\nCardinal Numbers & Interval Content\nCardinal \
Number\tNumber of Intervals\n1\t\t\t0 \t\t\t\n2\t\t\t0+1 \n...\n12\t\t\t\
0+1+2+3+4+5+6+7+8+9+10+11\nso k(k-1)/2 gives the number of intervals where k \
is the cardinal number.\nThis implies:\n\tIf k\[GreaterEqual]4, all 6 \
interval classes can be represented\n\tIf k=7, there is no empty entry\n\tIf \
k=5\n\tMax number of empty ic's for k=5 and k=6 is 3\n\tOdd cardinality ic's \
dominate even cardinality ic's\nA pair of pc sets which have identical \
interval vectors but are not transpositionally or inversionally equivalent \
are a \"Z-related pair\". There are 19 such pairs. \n\"Subset\" ", "Text",
  FontWeight->"Plain"]
}], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.5965597241550913`*^9, 3.596559763617588*^9}, {
   3.596559935362473*^9, 3.5965599651837063`*^9}, {3.596560011933107*^9, 
   3.596560046090507*^9}, {3.5973286160025063`*^9, 3.597328617057379*^9}, 
   3.597785601886919*^9, {3.597785896472601*^9, 3.597785995788238*^9}, {
   3.5977866488900747`*^9, 3.59778670507038*^9}, {3.597787870833099*^9, 
   3.597787886908512*^9}, 3.597787980001371*^9, {3.597788020862755*^9, 
   3.59778807889185*^9}, {3.597788162187264*^9, 3.597788178710623*^9}, {
   3.597788515244001*^9, 3.597788606203401*^9}, {3.597788641287403*^9, 
   3.5977886653502417`*^9}, {3.597789744518517*^9, 3.597789762601287*^9}, {
   3.597858458295875*^9, 3.597858483332436*^9}, {3.597858527248179*^9, 
   3.597858551053317*^9}, {3.5978845271168118`*^9, 3.5978845788177423`*^9}, {
   3.597884731283918*^9, 3.597884738905781*^9}, {3.5979337589494667`*^9, 
   3.59793377530538*^9}, {3.597956312007988*^9, 3.597956333345338*^9}},
 FormatType->"TextForm"]
},
WindowSize->{944, 753},
WindowMargins->{{Automatic, 226}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 515, 12, 119, "Input",
 Evaluatable->False],
Cell[1075, 34, 1341, 26, 271, "Text",
 Evaluatable->False],
Cell[2419, 62, 1561, 36, 99, "Input"],
Cell[3983, 100, 5920, 162, 351, "Input"],
Cell[CellGroupData[{
Cell[9928, 266, 15116, 302, 813, "Input"],
Cell[25047, 570, 11672, 270, 601, "Output"]
}, Open  ]],
Cell[36734, 843, 939, 17, 256, "Input",
 Evaluatable->False],
Cell[37676, 862, 4969, 135, 267, "Input"],
Cell[42648, 999, 2180, 33, 640, "Input",
 Evaluatable->False]
}
]
*)

(* End of internal cache information *)
