(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     28990,        706]
NotebookOptionsPosition[     28233,        678]
NotebookOutlinePosition[     28619,        695]
CellTagsIndexPosition[     28576,        692]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Pitch - Class Set Theory\n", "Title"],
 StyleBox["Based on ", "Subtitle"],
 StyleBox["The Structure of Atonal Music", "Subtitle",
  FontSlant->"Italic"],
 StyleBox[" by Allen Forte", "Subtitle"]
}], "Input",
 CellChangeTimes->{{3.597022881963623*^9, 3.597022900801791*^9}, 
   3.5970270934399767`*^9, {3.597027962230867*^9, 3.597027998114613*^9}},
 FontWeight->"Plain"],

Cell["\<\
A pitch - class set is a set of distinct integers representing pitch classes.
\tCardinal number of a set - number of permutations
\tNormal order - circular permutation for which difference between first and \
last is minimized.
  \tSet must be in ascending order, so 12 must be added appropriately
Interval vectors - \[OpenCurlyDoubleQuote]ics\[CloseCurlyDoubleQuote] show \
interval content:
\tThere are 6 intervals, as follows:
\t0=0
\t1=11
\t2=10
\t ....\
\>", "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.596208904798617*^9, 3.596208918211533*^9}, {
   3.596228054243074*^9, 3.596228054449111*^9}, {3.596368779642105*^9, 
   3.5963687966477947`*^9}, {3.596368903083796*^9, 3.596368904233522*^9}, {
   3.596369011281074*^9, 3.596369078529997*^9}, {3.596369268691723*^9, 
   3.59636927862435*^9}, {3.596371306817026*^9, 3.596371319984241*^9}, {
   3.59637184112173*^9, 3.596371852219036*^9}, {3.5963719272010813`*^9, 
   3.596371933403532*^9}, {3.597022948171289*^9, 3.597022949171311*^9}, 
   3.5970229798493347`*^9, {3.5970272499325237`*^9, 3.59702725237856*^9}, 
   3.597027596204381*^9, {3.597027767141212*^9, 3.597027833737894*^9}, {
   3.597027922046756*^9, 3.597027939964707*^9}, {3.597082772995331*^9, 
   3.597082820579516*^9}, {3.5978890000490437`*^9, 3.597889000783098*^9}},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"generates", " ", "random", " ", 
    RowBox[{"set", ".", " ", "not"}], " ", "used", " ", "for", " ", 
    "demonstration", " ", "atm"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GenerateSet", "[", 
    RowBox[{"notelen_", ",", "sl_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"row", "=", 
       RowBox[{"RandomSample", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "sl"}], "]"}], ",", "sl"}], "]"}]}], "}"}], ",", 
     RowBox[{"Sound", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SoundNote", "[", 
         RowBox[{
          RowBox[{"row", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "notelen"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.59620862632018*^9, 3.596208663237316*^9}, {
  3.596208699348735*^9, 3.5962087008772984`*^9}, {3.59620876114611*^9, 
  3.596208762666564*^9}, {3.596218029215061*^9, 3.596218067201882*^9}, {
  3.59621811193677*^9, 3.59621819626506*^9}, {3.596218342851235*^9, 
  3.59621836121882*^9}, {3.59621840007551*^9, 3.5962184020255327`*^9}, {
  3.596218442693451*^9, 3.5962184522014923`*^9}, {3.5963737386065187`*^9, 
  3.5963737737337923`*^9}, {3.596373983433772*^9, 3.596373993451654*^9}, {
  3.596374033366206*^9, 3.5963740985087147`*^9}, {3.5970256450477047`*^9, 
  3.597025656408182*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"plays", " ", "a", " ", "set"}], ",", " ", 
    RowBox[{"arpeggiated", " ", "then", " ", "as", " ", "a", " ", "chord"}]}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PlaySet", "[", 
     RowBox[{"row_", ",", "notelen_"}], "]"}], ":=", 
    RowBox[{"Sound", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"SoundNote", "[", 
        RowBox[{
         RowBox[{"row", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "notelen"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlaySetChord", "[", 
     RowBox[{"row_", ",", "notelen_"}], "]"}], ":=", 
    RowBox[{"Sound", "[", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SoundNote", "[", 
          RowBox[{
           RowBox[{"row", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"notelen", "/", "3"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"SoundNote", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"row", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}], ",", 
         "notelen"}], "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ButtonLabel", "[", 
     RowBox[{"ps_", ",", " ", "len_"}], "]"}], ":=", 
    RowBox[{"ImageCrop", "[", 
     RowBox[{
      RowBox[{"Rasterize", "[", 
       RowBox[{
        RowBox[{"PlaySet", "[", 
         RowBox[{"ps", ",", " ", "len"}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"200", ",", "40"}], "}"}], ",", "Bottom"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poss", "[", 
     RowBox[{"i_", ",", "tup_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ">", "6"}], " ", "&&",
        " ", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "<", "12"}]}], 
      ",", 
      RowBox[{"Mod", "[", 
       RowBox[{"12", ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"tup", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"tup", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "\[NotEqual]", 
         "0"}], ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"tup", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ICSet", "[", "ps_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"poss", "[", 
           RowBox[{"i", ",", 
            RowBox[{"Subsets", "[", 
             RowBox[{"ps", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"Subsets", "[", 
              RowBox[{"ps", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
         "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5977852466153793`*^9, 3.597785275873918*^9}, {
  3.597868920840928*^9, 3.597868990843499*^9}, {3.59788612271346*^9, 
  3.597886132911414*^9}, {3.597889236786187*^9, 3.5978892858331137`*^9}, {
  3.597889320823617*^9, 3.597889321726138*^9}, {3.597890083883922*^9, 
  3.597890086012679*^9}, {3.597890131344578*^9, 3.597890135625618*^9}, {
  3.5978909057707148`*^9, 3.597890941025403*^9}, {3.5978910626887302`*^9, 
  3.59789110809494*^9}, {3.597891292622336*^9, 3.597891310566132*^9}, {
  3.597921273071026*^9, 3.597921311546425*^9}, {3.59792144276007*^9, 
  3.597921490165641*^9}, {3.597922295495783*^9, 3.597922318858439*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Wozzeck", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Schoenberg", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Strauss", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5", ",", "7"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Major", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "5", ",", "6"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MTriad", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "8"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MScale", "=", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "1", ",", "3", ",", "5", ",", "6", ",", "8", ",", "10"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Random", "=", 
      RowBox[{"RandomSample", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "4"}], "]"}], ",", "4"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"\"\<Cardinal Number: \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Length", "[", "PCSet", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"Text", "[", 
             RowBox[{"\"\<Interval Vector: \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"ICSet", "[", "PCSet", "]"}], "]"}]}], "]"}]}], "}"}], 
          "}"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"ButtonLabel", "[", 
                RowBox[{"PCSet", ",", "1.2"}], "]"}], ",", " ", 
               RowBox[{"EmitSound", "[", 
                RowBox[{"Sound", "@", 
                 RowBox[{"PlaySet", "[", 
                  RowBox[{"PCSet", ",", " ", ".4"}], "]"}]}], "]"}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"ButtonLabel", "[", 
                RowBox[{"PCSet", ",", "1.2"}], "]"}], ",", " ", 
               RowBox[{"EmitSound", "[", 
                RowBox[{"Sound", "@", 
                 RowBox[{"PlaySet", "[", 
                  RowBox[{"PCSet", ",", " ", ".4"}], "]"}]}], "]"}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Invert\>\"", ",", "\"\<PrimeForm\>\""}], "}"}]}], 
          "}"}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"PlaySetChord", "[", 
         RowBox[{"PCSet", ",", "1.2"}], "]"}]}], "}"}], "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"PCSet", ",", 
       RowBox[{"{", 
        RowBox[{
        "Wozzeck", ",", "Schoenberg", ",", "Strauss", ",", "Major", ",", 
         "MTriad", ",", "MScale", ",", 
         RowBox[{"Random", "\[Rule]", "\"\<Random\>\""}]}], "}"}]}], "}"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.597021862199161*^9, 3.5970218633367157`*^9}, {
   3.597021930453701*^9, 3.597022004199657*^9}, {3.597022037336694*^9, 
   3.597022087678334*^9}, {3.5970222890805597`*^9, 3.597022316484498*^9}, {
   3.5970224056723003`*^9, 3.597022595679019*^9}, {3.597022703842729*^9, 
   3.597022757151936*^9}, {3.597025334913651*^9, 3.5970253544458113`*^9}, {
   3.5970254398153133`*^9, 3.5970254610145617`*^9}, {3.597025501083084*^9, 
   3.597025537823347*^9}, 3.597025701568284*^9, {3.597025830739592*^9, 
   3.59702584339375*^9}, {3.5970262709600983`*^9, 3.597026286309403*^9}, {
   3.597026419873219*^9, 3.597026432550514*^9}, {3.597026470626657*^9, 
   3.597026513671096*^9}, {3.5970265763906097`*^9, 3.597026591573636*^9}, {
   3.597026911461616*^9, 3.597027004252172*^9}, {3.597027037184567*^9, 
   3.597027045792961*^9}, {3.597027168138825*^9, 3.59702716830407*^9}, {
   3.5970272032573757`*^9, 3.597027207213114*^9}, {3.5970272989895477`*^9, 
   3.597027325866*^9}, {3.5970274219989567`*^9, 3.5970274754496403`*^9}, {
   3.597027505583886*^9, 3.5970275235351887`*^9}, 3.597028102723918*^9, {
   3.5970855760611467`*^9, 3.597085599033709*^9}, {3.597785013412531*^9, 
   3.597785110253536*^9}, {3.5978660964324417`*^9, 3.597866097677882*^9}, {
   3.597866372136101*^9, 3.59786647749648*^9}, {3.597866513497402*^9, 
   3.597866536524675*^9}, {3.597866921781252*^9, 3.597866928883366*^9}, {
   3.59786743296122*^9, 3.597867466435232*^9}, {3.5978680636630583`*^9, 
   3.597868078181417*^9}, {3.597868110514762*^9, 3.597868112186572*^9}, {
   3.597868306752954*^9, 3.597868310584206*^9}, {3.597868607775241*^9, 
   3.5978686210380373`*^9}, {3.5978689725823307`*^9, 3.597869121300373*^9}, {
   3.597869167723785*^9, 3.597869177698106*^9}, {3.5978791383016376`*^9, 
   3.597879187464333*^9}, {3.59788548393533*^9, 3.597885638334324*^9}, {
   3.5978857340388393`*^9, 3.597885780731276*^9}, {3.597885912924794*^9, 
   3.5978859657020493`*^9}, {3.597885996955361*^9, 3.597886097300259*^9}, {
   3.597889747696849*^9, 3.597889748270719*^9}, {3.597922349652714*^9, 
   3.597922354966466*^9}, {3.597922433065184*^9, 3.597922511987988*^9}, 
   3.597922569651194*^9, {3.59792262997233*^9, 3.597922725098731*^9}}],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`Wozzeck$$ = {1, 2, 
  3}, $CellContext`Schoenberg$$ = {2, 3, 4}, $CellContext`Strauss$$ = {4, 5, 
  7}, $CellContext`Major$$ = {1, 3, 5, 6}, $CellContext`MTriad$$ = {1, 5, 
  8}, $CellContext`MScale$$ = {0, 1, 3, 5, 6, 8, 10}, Random$$ = {4, 2, 1, 
  3}}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{$CellContext`PCSet$$ = {1, 2, 3}, Typeset`show$$ = True,
      Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
     Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
     "\"untitled\"", Typeset`specs$$ = {{
       Hold[$CellContext`PCSet$$], {{1, 2, 3}, {2, 3, 4}, {4, 5, 7}, {1, 3, 5,
         6}, {1, 5, 8}, {0, 1, 3, 5, 6, 8, 10}, {4, 2, 1, 3} -> "Random"}}}, 
     Typeset`size$$ = {347., {114.4375, 121.5625}}, Typeset`update$$ = 0, 
     Typeset`initDone$$, Typeset`skipInitDone$$ = 
     True, $CellContext`PCSet$247264$$ = False}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, "Variables" :> {$CellContext`PCSet$$ = {1, 2, 3}}, 
       "ControllerVariables" :> {
         Hold[$CellContext`PCSet$$, $CellContext`PCSet$247264$$, False]}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Column[{
          Grid[{{
             Text[
              StringJoin["Cardinal Number: ", 
               ToString[
                Length[$CellContext`PCSet$$]]]], 
             Text[
              StringJoin["Interval Vector: ", 
               ToString[
                $CellContext`ICSet[$CellContext`PCSet$$]]]]}}], 
          Grid[{{
             Button[
              $CellContext`ButtonLabel[$CellContext`PCSet$$, 1.2], 
              EmitSound[
               Sound[
                $CellContext`PlaySet[$CellContext`PCSet$$, 0.4]]]], 
             Button[
              $CellContext`ButtonLabel[$CellContext`PCSet$$, 1.2], 
              EmitSound[
               Sound[
                $CellContext`PlaySet[$CellContext`PCSet$$, 0.4]]]]}, {
            "Invert", "PrimeForm"}}], 
          $CellContext`PlaySetChord[$CellContext`PCSet$$, 1.2]}], 
       "Specifications" :> {{$CellContext`PCSet$$, {{1, 2, 3}, {2, 3, 4}, {4, 
           5, 7}, {1, 3, 5, 6}, {1, 5, 8}, {0, 1, 3, 5, 6, 8, 
           10}, {4, 2, 1, 3} -> "Random"}}}, "Options" :> {}, 
       "DefaultOptions" :> {}],
      ImageSizeCache->{402., {168., 175.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{3.5979227757782717`*^9}]
}, Open  ]],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`Wozzeck$$ = {1, 2, 
  3}, $CellContext`Schoenberg$$ = {2, 3, 4}, $CellContext`Strauss$$ = {4, 5, 
  7}, $CellContext`Major$$ = {1, 3, 5, 6}, $CellContext`MTriad$$ = {1, 5, 
  8}, $CellContext`MScale$$ = {0, 1, 3, 5, 6, 8, 10}, Random$$ = {3, 4, 0, 
  1}}, 
  TagBox[
   StyleBox[
    DynamicModuleBox[{$CellContext`PCSet$$ = {1, 2, 3}, Typeset`show$$ = True,
      Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
     Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
     "\"untitled\"", Typeset`specs$$ = {{
       Hold[$CellContext`PCSet$$], {{1, 2, 3}, {2, 3, 4}, {4, 5, 7}, {1, 3, 5,
         6}, {1, 5, 8}, {0, 1, 3, 5, 6, 8, 10}, {3, 4, 0, 1} -> "Random"}}}, 
     Typeset`size$$ = {347., {114.4375, 121.5625}}, Typeset`update$$ = 0, 
     Typeset`initDone$$, Typeset`skipInitDone$$ = 
     True, $CellContext`PCSet$246161$$ = False}, 
     DynamicBox[Manipulate`ManipulateBoxes[
      1, StandardForm, "Variables" :> {$CellContext`PCSet$$ = {1, 2, 3}}, 
       "ControllerVariables" :> {
         Hold[$CellContext`PCSet$$, $CellContext`PCSet$246161$$, False]}, 
       "OtherVariables" :> {
        Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
         Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
         Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
         Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Column[{
          Grid[{{
             Text[
              StringJoin["Cardinal Number: ", 
               ToString[
                Length[$CellContext`PCSet$$]]]], 
             Text[
              StringJoin["Interval Vector: ", 
               ToString[
                $CellContext`ICSet[$CellContext`PCSet$$]]]]}}], 
          Grid[{{
             Button[
              $CellContext`ButtonLabel[$CellContext`PCSet$$, 1.2], 
              EmitSound[
               Sound[
                $CellContext`PlaySet[$CellContext`PCSet$$, 0.4]]]], 
             Button[
              $CellContext`ButtonLabel[$CellContext`PCSet$$, 1.2], 
              EmitSound[
               Sound[
                $CellContext`PlaySet[$CellContext`PCSet$$, 0.4]]]]}, {
            "Invert", "PrimeForm"}}], 
          $CellContext`PlaySetChord[$CellContext`PCSet$$, 1.2]}], 
       "Specifications" :> {{$CellContext`PCSet$$, {{1, 2, 3}, {2, 3, 4}, {4, 
           5, 7}, {1, 3, 5, 6}, {1, 5, 8}, {0, 1, 3, 5, 6, 8, 
           10}, {3, 4, 0, 1} -> "Random"}}}, "Options" :> {}, 
       "DefaultOptions" :> {}],
      ImageSizeCache->{402., {168., 175.}},
      SingleEvaluation->True],
     Deinitialization:>None,
     DynamicModuleValues:>{},
     SynchronousInitialization->True,
     UnsavedVariables:>{Typeset`initDone$$},
     UntrackedVariables:>{Typeset`size$$}], "Manipulate",
    Deployed->True,
    StripOnInput->False],
   Manipulate`InterpretManipulate[1]],
  DynamicModuleValues:>{}]], "Input",
 CellChangeTimes->{3.597922770005744*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "normal", ",", " ", "prime", ",", " ", "inversion", ",", " ", "IC"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.597885300944031*^9, 3.597885308552537*^9}}],

Cell[TextData[{
 StyleBox["normal order, prime form:", "Subsubsection",
  FontWeight->"Plain"],
 StyleBox["\n1) cperm moves first element to end, \n2) cpermordered adds 12 \
to ensure order\n3) makeCPerm applies cpermordered to cperm\n4) cperms \
applies makeCPerm to every element of the list\n5) normalOrder gets the \
normal order of a cperm\n6) primeForm gets prime form by transposing normal \
order so that the first element is 0\n6) transpose adds a number to each \
element\n7) inverse transforms each element to its mod 12 equivalent", "Text",
  
  FontWeight->"Plain"]
}], "Input",
 CellChangeTimes->{{3.596371974343377*^9, 3.596371978611487*^9}, {
  3.596541637529804*^9, 3.5965416684603367`*^9}, {3.5977851549284077`*^9, 
  3.597785166122993*^9}, {3.5977853039031353`*^9, 3.597785322763446*^9}, {
  3.597785422751733*^9, 3.597785631072915*^9}},
 FormatType->"TextForm",
 Background->RGBColor[0.87, 0.94, 1]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cperm", "[", "set_", "]"}], ":=", 
  RowBox[{"Delete", "[", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{"set", ",", 
      RowBox[{"set", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cpermordered", "[", "cp_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"cp", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<", 
       RowBox[{"cp", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"cp", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "+", "12"}], ",", 
      RowBox[{"cp", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "cp", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeCPerm", "[", "pc_", "]"}], ":=", 
  RowBox[{"cpermordered", "[", 
   RowBox[{"cperm", "[", "pc", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cperms", "[", "s_", "]"}], ":=", 
  RowBox[{"NestList", "[", 
   RowBox[{"makeCPerm", ",", "s", ",", 
    RowBox[{
     RowBox[{"Length", "[", "s", "]"}], "-", "1"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalOrder", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "s", "]"}]}], "]"}], "]"}], "-", 
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "<", 
       RowBox[{"#2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"primeForm", "[", "s_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", "=", 
      RowBox[{"-", 
       RowBox[{"s", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"transpose", "[", 
     RowBox[{
      RowBox[{"normalOrder", "[", 
       RowBox[{"cperms", "[", "s", "]"}], "]"}], ",", "t"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transpose", "[", 
   RowBox[{"s_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "+", "n"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inverse", "[", "s_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"12", "-", 
       RowBox[{"s", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", "12"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.596544752042263*^9, 3.5965447547583647`*^9}, {
   3.596544796330575*^9, 3.596544833434033*^9}, {3.59654607714474*^9, 
   3.596546196934073*^9}, {3.596546235705632*^9, 3.596546274296529*^9}, {
   3.596546383642956*^9, 3.5965463853605957`*^9}, {3.5965465419027157`*^9, 
   3.596546570942202*^9}, {3.596546642838084*^9, 3.59654664899164*^9}, 
   3.596559311853725*^9, {3.596559342244547*^9, 3.596559346197843*^9}, {
   3.596560067048818*^9, 3.596560067991784*^9}, {3.5965606211250477`*^9, 
   3.596560646903101*^9}, {3.5977855529937277`*^9, 3.597785553632471*^9}, {
   3.597785603379655*^9, 3.5977856035735197`*^9}}],

Cell[TextData[{
 StyleBox["Interval Classes\n", "Subsubsection",
  FontWeight->"Plain"],
 StyleBox["Interval vectors - \"ics\" show interval content:\n\tThere are 6 \
intervals, as follows:\n\t0=0\n\t1=11\n\t2=10\n\t ....\nInterval vectors are \
of this form [abcdef] where a represents the number of occurrences of \
interval 0, b number of occurrences of interval 1, etc. \nThree properties: \
'unique vector entries', 'maximum number of some ic', 'near equal \
distribution if entires'\nCardinal Numbers & Interval Content\nCardinal \
Number\tNumber of Intervalsd\n1\t\t\t0 \t\t\t\n2\t\t\t0+1 \n...\n12\t\t\t\
0+1+2+3+4+5+6+7+8+9+10+11\nso k(k-1)/2 gives the number of intervals where k \
is the cardinal number.\nThis implies:\n\tIf k\[GreaterEqual]4, all 6 \
interval classes can be represented\n\tIf k=7, there is no empty entry\n\tIf \
k=5\n\tMax number of empty ic's for k=5 and k=6 is 3\n\tOdd cardinality ic's \
dominate even cardinality ic's\nA pair of pc sets which have identical \
interval vectors but are not transpositionally or inversionally equivalent \
are a \"Z-related pair\". There are 19 such pairs. \n\"Subset\" \n\n\n", 
  "Text",
  FontWeight->"Plain"]
}], "Input",
 CellChangeTimes->{{3.5965597241550913`*^9, 3.596559763617588*^9}, {
   3.596559935362473*^9, 3.5965599651837063`*^9}, {3.596560011933107*^9, 
   3.596560046090507*^9}, {3.5973286160025063`*^9, 3.597328617057379*^9}, 
   3.597785601886919*^9, {3.597785896472601*^9, 3.597785995788238*^9}, {
   3.5977866488900747`*^9, 3.59778670507038*^9}, {3.597787870833099*^9, 
   3.597787886908512*^9}, 3.597787980001371*^9, {3.597788020862755*^9, 
   3.59778807889185*^9}, {3.597788162187264*^9, 3.597788178710623*^9}, {
   3.597788515244001*^9, 3.597788606203401*^9}, {3.597788641287403*^9, 
   3.5977886653502417`*^9}, {3.597789744518517*^9, 3.597789762601287*^9}, {
   3.597858458295875*^9, 3.597858483332436*^9}, {3.597858527248179*^9, 
   3.597858551053317*^9}, {3.5978845271168118`*^9, 3.5978845788177423`*^9}, {
   3.597884731283918*^9, 3.597884738905781*^9}},
 FormatType->"TextForm"]
},
WindowSize->{944, 775},
WindowMargins->{{30, Automatic}, {0, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 396, 9, 119, "Input"],
Cell[956, 31, 1341, 26, 271, "Text",
 Evaluatable->False],
Cell[2300, 59, 1561, 36, 99, "Input"],
Cell[3864, 97, 5387, 148, 330, "Input"],
Cell[CellGroupData[{
Cell[9276, 249, 5730, 117, 414, "Input"],
Cell[15009, 368, 2974, 63, 397, "Output"]
}, Open  ]],
Cell[17998, 434, 2971, 63, 363, InheritFromParent],
Cell[20972, 499, 199, 5, 35, "Input"],
Cell[21174, 506, 919, 17, 256, "Input"],
Cell[22096, 525, 4058, 117, 246, "Input"],
Cell[26157, 644, 2072, 32, 711, "Input"]
}
]
*)

(* End of internal cache information *)
